
<p align="center">
  <img src="https://digitalbusiness.kz/wp-content/uploads/2022/11/indrive-logo_ok-01.png" alt="Car Example" width="400"/>
  
</p>


# Определение состояния автомобиля по фото

## Общие сведения

Определение состояния автомобиля по фото.

## Подробное описание задачи

Модель по фото определяет: грязный / чистый, битый / целый. Помогает повысить безопасность, доверие пассажиров и качество сервиса inDrive.

## Проблема

- Нет автоматического, масштабируемого способа оценивать внешний вид и повреждения автомобилей.

- Пассажиры получают непредсказуемый опыт (грязная или повреждённая машина → недовольство, жалобы).

- Оперативный контроль качества у сервиса фрагментирован и часто ручной.

- Водители редко получают напоминания о поддержании машины в хорошем состоянии.

## Ценность (зачем это нужно inDrive)

- Доверие пассажиров — визуальные метки/индикации повышают уверенность при выборе поездки.

- Качество сервиса — автоматическая проверка позволяет поддерживать стандарты и быстрее устранять несоответствия.

- Safety-сигналы в UI — предупреждения о серьёзных повреждениях или опасных ситуациях (сломанные фары, разбитое стекло).

# Новая операционная ценность:

- Напоминание водителю: push/внутреннее уведомление — помыть авто, устранить мелкие повреждения.

- Предупреждение пассажиру: показ в приложении (например «машина имеет следы повреждений/грязи»).

- Сигнал в систему качества: агрегированные отчёты для аналитики, KPI и компенсаций.

- Экономическая польза — снижение числа жалоб и возвратов, улучшение удержания клиентов и рейтингов.

- Маркетинговая польза — возможность позиционировать сервис как более надёжный и заботящийся о комфорте.

## Данные & разметка  

- **Чистый / грязный автомобиль**:  
  - Датасет собирался самостоятельно.  
  - Источники изображений: OLX, Baidu, Avito (поиск по объявлениям).  
  - Изображения скачивались по URL и вручную сортировались по категориям.  
  - Разметка выполнялась вручную: каждое фото классифицировалось как "чистый" или "грязный".  

- **Битый / целый автомобиль**:  
  - Использован открытый датасет **CarDD**.  
  - Источник:  
    ```bibtex
    @article{CarDD,
        author={Wang, Xinkuang and Li, Wenjing and Wu, Zhongcheng},
        journal={IEEE Transactions on Intelligent Transportation Systems}, 
        title={CarDD: A New Dataset for Vision-Based Car Damage Detection}, 
        year={2023},
        volume={24},
        number={7},
        pages={7202-7214},
        doi={10.1109/TITS.2023.3258480}
    }
    ```
## Модель & подход  

- Используется **двухэтапный пайплайн**:  
  1. **Детекция автомобиля**:  
     - На вход подаётся фото.  
     - Сначала применяется **YOLO11-M** для поиска автомобиля.  
     - Если объект "автомобиль" не найден → возвращается результат "нет машины".  
     - Если найден → изображение кропается по детекции.  

  2. **Классификация состояния**:  
     - Для **чистый / грязный**: используется **EfficientNet-B1**.  
     - Для **битый / целый**: используется **EfficientNet-B2**.  

- Дополнительный шаг для задачи "битый / целый":  
  - Так как в датасете CarDD изображения часто приближены к зонам повреждений, а входная фотография может содержать машину целиком, вводится приём разбиения изображения.  
  - После кропа с YOLO изображение делится на **4 сегмента**.  
  - Каждый сегмент подаётся в EfficientNet-B2.  
  - Если хотя бы **один сегмент классифицируется как "битый"**, вся машина считается "битой".  

- **Обоснование подхода**:  
  - YOLO11-M гарантирует, что классификаторы работают только по объекту "автомобиль", а не по фону.  
  - Разделение на сегменты позволяет находить локальные повреждения, которые могли бы быть потеряны на полном изображении.  
  - Использование разных моделей (B1 и B2) оптимизирует работу под разные подзадачи.  




